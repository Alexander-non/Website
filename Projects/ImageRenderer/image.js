let canvas = document.querySelector("canvas");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
let ctx = canvas.getContext("2d");

let RGBA = [0,0,0,0]
let scaleRate = 5
let image = new Image();
image.setAttribute('crossOrigin', '');
let imageWidth = 500;
let imageHeight = 500;
image.src = "data:image/jpeg;base64,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"



function update() {  
    requestAnimationFrame(update);
    ctx.clearRect(0,0,innerWidth,innerHeight)
    ctx.drawImage(image, 0, 0, imageWidth, imageHeight);
    let imgData = ctx.getImageData(0, 0, imageWidth/scaleRate, imageHeight/scaleRate);
    for (let x = 0; x < imageWidth/scaleRate; x++) {
        for (let y = 0; y < imageHeight/scaleRate; y++) {
            imgData = ctx.getImageData(scaleRate*x, scaleRate*y, scaleRate, scaleRate);
            for (let i = 0; i < imgData.data.length; i += 4) {
                RGBA[0] += imgData.data[i];
                RGBA[1] += imgData.data[i+1];
                RGBA[2] += imgData.data[i+2];
                RGBA[3] += imgData.data[i+3];
            }
            ctx.fillStyle = `rgb(${RGBA[0]/Math.pow(scaleRate, 2)},${RGBA[1]/Math.pow(scaleRate, 2)},${RGBA[2]/Math.pow(scaleRate, 2)},${RGBA[3]/Math.pow(scaleRate, 2)})`;
            console.table(scaleRate*x, scaleRate*y, scaleRate*(x+1), scaleRate*(y+1))
            ctx.fillRect(x*scaleRate+imageWidth, y*scaleRate, scaleRate, scaleRate);
            RGBA = [0,0,0,0]
        }
    }
}
update()